% Copyright (C) 2008, 2009, 2010, 2012, 2014 Bert Burgemeister
%
% Permission is granted to copy, distribute and/or modify this
% document under the terms of the GNU Free Documentation License,
% Version 1.2; with no Invariant Sections, no Front-Cover Texts and
% no Back-Cover Texts. For details see file COPYING.
%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{结构}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{LIST}{1cm}
  
  \IT{(\MC*{DEFSTRUCT}
    \xorGOO{\VAR{foo}\\
      (\VAR{foo\hspace{.5ex}}
      \orGOO{%
        \xorGOO{%
          \kwd{:conc-name}\\
          (\kwd{:conc-name } \Op{\NEV{\VAR{slot-prefix}}\DF{\VAR{foo}\LIT{-}}})}{.}\\
        \xorGOO{%
          \kwd{:constructor}\\
          (\kwd{:constructor }
          \OP{\NEV{\VAR{maker}}\DF{\LIT{MAKE-}\VAR{foo}}\text{ }
            \Op{({\OPn{\NEV{\VAR{ord-$\lambda$}}}})}})}{\}^{\!\!*}}\\
        \xorGOO{%
          \kwd{:copier}\\
          (\kwd{:copier }
          \Op{\NEV{\VAR{copier}}\DF{\LIT{COPY-}\VAR{foo}}})}{.}\\
        (\kwd{:include\hspace{.5ex}} \NEV{\VAR{struct}}% disabled to save space %\text{ }
        \xorGOO{%
          \NEV{\VAR{slot}}\\
          (\NEV{\VAR{slot}}\text{\hspace{.5ex}} \Op{\VAR{init}% disabled to save space %\text{ }
            \orGOO{
              \kwd{:type\hspace{.5ex}} \NEV{\VAR{sl-type}}\\
              \kwd{:read-only } \NEV{\VAR{b}}}{\}}})\\
        }{\}^{\!\!*}})\\
        \xorGOO{
          (\kwd{:type } \xorGOO{\kwd{list}\\
            \kwd{vector}\\
            (\kwd{vector }\NEV{\VAR{type}})}{\}})\text{ }
          \orGOO{%
            \kwd{:named}\\
            (\kwd{:initial-offset } \NEV{\VAR{n}})\\
          }{.}\\
          \xorGOO{
            (\kwd{:print-object } \Op{\NEV{\VAR{o-printer}}})\\
            (\kwd{:print-function } \Op{\NEV{\VAR{f-printer}}})
          }{.}
        }{.}\\
        \xorGOO{%
          \kwd{:predicate}\\
          (\kwd{:predicate } \Op{\NEV{\VAR{p-name}}\DF{\VAR{foo}\LIT{-P}}})}{.}
      }{\}}%
      )%
    }{\}}
    \Op{\NEV{\VAR{doc}}}
    \xorGOO{
      \VAR{slot}\\
      (\VAR{slot } \Op{\VAR{init}\text{ }
        \orGOO{
          \kwd{:type } \NEV{\VAR{slot-type}}\\
          \kwd{:read-only } \NEV{\VAR{bool}}
        }{\}}})
    }{\}^{\!\!*}}%
    )}
  {
    定义结构 \retval{\VAR{foo}}，函数
    \LIT{MAKE-}\VAR{foo}、\LIT{COPY-}\VAR{foo}、\VAR{foo}\LIT{-P}，可
    \kwd{setf} 的存取器
    \VAR{foo}\LIT{-}\VAR{slot}。实例为类 \VAR{foo} 的实例，如果指定了
    \kwd{defstruct} 选项
    \kwd{:type}，则为指定的类型。可通过
    (\LIT{MAKE-}\VAR{foo} \Goos{\kwd{:}\VAR{slot}
      \VAR{value}}) 创建实例，当指定 \VAR{ord-$\lambda$}（参见第
    \pageref{section:函数} 页）时，也可使用 (\VAR{maker}
    \OPn{\VAR{arg}} \Goos{\kwd{:}\VAR{key}
    \VAR{value}})。在后一种情况中，\VAR{arg}s 与 \kwd{:}\VAR{key}s 对应
    \VAR{ord-$\lambda$} 中定义的位置和关键字参数，其
    \VAR{var}s 对应
    \VAR{slot}s。\kwd{:print-object}/\kwd{:print-function} 分别为
    \VAR{foo} 的实例 \VAR{bar} 生成 \GFU{print-object} 方法
    (\VAR{o-printer} \VAR{bar} \VAR{stream}) 或 (\VAR{f-printer}
    \VAR{bar} \VAR{stream} \VAR{print-level})。如果
    \kwd{:type} 不带 \kwd{:named}，则不会创建
    \VAR{foo}\LIT{-P}。
}

  \IT{(\FU*{COPY-STRUCTURE} \VAR{structure})}
  {
    返回共享槽值的 \retval{\VAR{structure} 副本}。
  }

\end{LIST}



%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "clqr"
%%% End: 
